webpackJsonp([3],{252:function(s,o,n){"use strict";s.exports=function(s){var o=n(182);if(o.getUserRole()===Enums.UserRole.NormalUser){var t=n(253);return t.init(s),{start:function(s){t.ShowSingleMailChangePasswordInCommonSettings&&s.run("SettingsWebclient","registerSettingsTabSection",[function(){return n(254)},"common","common"])},getChangePasswordPopup:function(){return n(255)},isChangePasswordButtonAllowed:function(s,o){return(!t.ShowSingleMailChangePasswordInCommonSettings||s>1)&&!!o.aExtend.AllowChangePasswordOnMailServer}}}return null}},253:function(s,o,n){"use strict";var t=n(2),e=n(181);s.exports={ShowSingleMailChangePasswordInCommonSettings:!1,init:function(s){var o=s.ChangePasswordWebclient;t.isEmpty(o)||(this.ShowSingleMailChangePasswordInCommonSettings=e.pBool(o.ShowSingleMailChangePasswordInCommonSettings,this.ShowSingleMailChangePasswordInCommonSettings))}}},254:function(s,o,n){"use strict";function t(){this.oSingleMailAccount=null,this.showChangePasswordButton=r.observable(!1),this.init()}var e=n(2),r=n(44),i=n(42),a=n(192),h=i.run("ChangePasswordWebclient","getChangePasswordPopup");n(253);t.prototype.ViewTemplate="ChangePasswordWebclient_ChangeSingleMailAccountPasswordView",t.prototype.init=function(){var s=i.run("MailWebclient","getAccountList",[]),o=function(){1===s.collection().length?(this.oSingleMailAccount=s.collection()[0],this.showChangePasswordButton(!0)):(this.oSingleMailAccount=null,this.showChangePasswordButton(!1))}.bind(this);s&&e.isFunction(s.collection)&&(o(),s.collection.subscribe(o))},t.prototype.changePassword=function(){this.oSingleMailAccount&&a.showPopup(h,[{iAccountId:this.oSingleMailAccount.id(),sModule:"Mail",bHasOldPassword:!0}])},s.exports=new t},255:function(s,o,n){"use strict";function t(){w.call(this),this.currentPassword=i.observable(""),this.newPassword=i.observable(""),this.confirmPassword=i.observable(""),this.accountId=i.observable(""),this.hasOldPassword=i.observable(!1),this.oParams=null}var e=n(2),r=n(1),i=n(44),a=n(185),h=n(179),c=n(256),u=n(191),l=n(186),d=n(188),w=n(194);e.extendOwn(t.prototype,w.prototype),t.prototype.PopupTemplate="ChangePasswordWebclient_ChangePasswordPopup",t.prototype.onOpen=function(s){this.currentPassword(""),this.newPassword(""),this.confirmPassword(""),this.accountId(s.iAccountId),this.hasOldPassword(s.bHasOldPassword),this.oParams=s},t.prototype.change=function(){var s=r.trim(this.newPassword()),o=r.trim(this.confirmPassword());c.checkPassword(s,o)&&this.sendChangeRequest()},t.prototype.sendChangeRequest=function(){var s={AccountId:this.accountId(),CurrentPassword:r.trim(this.currentPassword()),NewPassword:r.trim(this.newPassword())},o={Module:this.oParams.sModule,Method:"ChangePassword"};u.send(this.oParams.sModule,"ChangePassword",s,this.onUpdatePasswordResponse,this),u.abortAndStopSendRequests(o)},t.prototype.onUpdatePasswordResponse=function(s,o){s.Result===!1?(l.showErrorByCode(s,a.i18n("CHANGEPASSWORDWEBCLIENT/ERROR_PASSWORD_NOT_SAVED")),u.startSendRequests()):s.Result&&s.Result.RefreshToken?(r.cookie("AuthToken",s.Result.RefreshToken,{expires:30}),h.clearAndReloadLocation(!0,!1)):(this.hasOldPassword()?d.showReport(a.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_CHANGED")):d.showReport(a.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_SET")),this.closePopup(),r.isFunction(this.oParams.fAfterPasswordChanged)&&this.oParams.fAfterPasswordChanged())},s.exports=new t},256:function(s,o,n){"use strict";var t=n(2),e=n(188),r={};r.checkIfFieldsEmpty=function(s,o){var n=t.find(s,function(s){return""===s()});return!n||(o&&e.showError(o),n.focused(!0),!1)},r.checkPassword=function(s,o){var t=n(185),r=n(43),i=!1;return o!==s?e.showError(t.i18n("COREWEBCLIENT/ERROR_PASSWORDS_DO_NOT_MATCH")):r.PasswordMinLength>0&&s.length<r.PasswordMinLength?e.showError(t.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SHORT").replace("%N%",r.PasswordMinLength)):!r.PasswordMustBeComplex||s.match(/([0-9])/)&&s.match(/([!,%,&,@,#,$,^,*,?,_,~])/)?i=!0:e.showError(t.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SIMPLE")),i},s.exports=r}});